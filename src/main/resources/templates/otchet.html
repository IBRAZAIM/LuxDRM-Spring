<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Отчетность продаж</title>
    <link rel="stylesheet" th:href="@{/sales.css}">
</head>
<body>
<div class="left-panel">
    <header>
        <h2 class="logo-left">UXD</h2>
    </header>

    <nav>
        <ul class="items">
            <li class="item active">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#6366F1" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                      <rect x="3" y="3" width="7" height="7" rx="1.5"/>
                      <rect x="14" y="3" width="7" height="4" rx="1.2"/>
                      <rect x="3" y="12" width="7" height="9" rx="1.2"/>
                      <rect x="14" y="11" width="7" height="10" rx="1.5"/>
                    </svg>
                </span>
                <span class="text">Обзор</span>
            </li>
            <li class="item"><span class="text">Финансы</span></li>
            <li class="item"><span class="text">CRM</span></li>
            <li class="item"><span class="text">Товары</span></li>
            <li class="item"><span class="text">Заказы</span></li>
        </ul>
    </nav>

    <footer class="account-info">
        <div th:if="${user != null}">
            <span th:text="${user.name}"></span>
        </div>
        <div th:if="${user == null}">
            <a href="/login">Вход</a>
        </div>
    </footer>
</div>

<main class="right-content">
    <div class="top-nav">
        <nav class="breadcrumb">
            <span class="crumb">Главная</span>
            <span class="separator">/</span>
            <span class="crumb active">Отчеты</span>
        </nav>
        <div class="actions">
            <a class="btn settings" href="/main">На витрину</a>
        </div>
    </div>

    <div class="reports">
        <div class="report-toolbar">
            <div class="period-tabs">
                <button class="period-btn active" data-period="TODAY">Сегодня</button>
                <button class="period-btn" data-period="WEEK">Неделя</button>
                <button class="period-btn" data-period="MONTH">Месяц</button>
                <button class="period-btn" data-period="QUARTER">Квартал</button>
                <button class="period-btn" data-period="YEAR">Год</button>
                <button class="period-btn" data-period="ALL">За все время</button>
            </div>

            <div class="date-range">
                <label><input id="customStart" type="date"></label>
                <span class="dash">-</span>
                <label><input id="customEnd" type="date"></label>
                <button id="applyCustom" class="apply-btn" type="button">Применить</button>
            </div>
        </div>

        <div class="meta-row">
            <span id="periodLabel">Период: сегодня</span>
            <span id="updatedAt">Обновлено: --:--</span>
        </div>

        <div class="report-grid">
            <div class="report-card wide">
                <h3>Общие продажи</h3>
                <p id="kpiSales" class="report-value" th:text="${overview.totalSales()}">0</p>
            </div>

            <div class="report-card">
                <h3>Посещений</h3>
                <p id="kpiVisits" class="report-value" th:text="${overview.visitsToday()}">0</p>
            </div>

            <div class="report-card">
                <h3>Заказы</h3>
                <p id="kpiOrders" class="report-value" th:text="${overview.ordersToday()}">0</p>
            </div>

            <div class="report-card">
                <h3>Конверсия</h3>
                <p id="kpiConversion" class="report-value" th:text="${overview.conversion() + '%'}">0%</p>
            </div>

            <div class="report-card">
                <h3>Средний чек</h3>
                <p id="kpiAverageCheck" class="report-value">0</p>
            </div>

            <div class="report-card">
                <h3>Доход с визита</h3>
                <p id="kpiRevenuePerVisit" class="report-value">0</p>
            </div>
        </div>

        <div class="analytics-grid">
            <div class="report-card chart-card">
                <h3>Выручка</h3>
                <div class="chart-wrap"><canvas id="revenueChart"></canvas></div>
            </div>
            <div class="report-card chart-card">
                <h3>Трафик и заказы</h3>
                <div class="chart-wrap"><canvas id="trafficChart"></canvas></div>
            </div>
            <div class="report-card chart-card">
                <h3>Конверсия</h3>
                <div class="chart-wrap"><canvas id="conversionChart"></canvas></div>
            </div>
            <div class="report-card insights-card">
                <h3>Инсайты</h3>
                <ul id="insightsList"></ul>
            </div>
        </div>
    </div>
</main>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script th:src="@{/js/sales.js}"></script>
</body>
</html>
